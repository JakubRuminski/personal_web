<label for=buttonA4> server_solution_additional.py: </label>
                            <button type="button" id='buttonA4' class='visibility_button' onClick="changeFileVisibility('buttonA4')"> View File </button>
                            <button type="button" id='lightbuttonA4' onClick="changeFileBackground('lightbuttonA4')">ðŸŒš</button>
                            <code class='file_code'><pre style='display: none;'><code class='comment'># from the socket module import all</code><br><code class='statements1'>from</code> socket <code class='statements1'>import</code> *<br><code class='statements1'>from</code> datetime <code class='statements1'>import</code> *<br><code class='statements1'>import</code> threading<br><br>sock = <code class='brackets'><code class='function'>socket</code>(AF_INET, SOCK_STREAM)</code><br><br>hostname = <code class='brackets'><code class='function'>gethostname</code>()</code><br>host_ip = <code class='brackets'><code class='function'>gethostbyname</code>(hostname)</code><br><br>PORT = 10000<br>server_address = <code class='brackets'><code class='function'></code>(host_ip, PORT)</code><br><br><code class='brackets'><code class='function'>print</code>(<code class='string'>"-------------\n"</code><br>      <code class='string'>"Domain name: %s\n"</code><br>      <code class='string'>"IP address %s\n"</code><br>      <code class='string'>"-------------"</code> % <code class='brackets'><code class='function'></code>(hostname, host_ip)</code>)</code><br><br><code class='brackets'><code class='function'>print</code>(<code class='string'>'*** Server is starting up on %s port %s ***'</code> % server_address)</code><br><code class='brackets'><code class='function'><code class=brackets>sock.</code>bind</code>(server_address)</code><br><br><code class='string'>''</code><code class='string'>'<br> Places message fragment into logtxt<br><br> @:param message The message to be logged<br>'</code><code class='string'>''</code><br><code class='statements2'>def</code> <code class='brackets'><code class='function'>logMessage</code>(message)</code>:<br>    file = <code class='brackets'><code class='function'>open</code>(<code class='string'>"logtxt"</code>, <code class='string'>"a"</code>)</code><br>    message = <code class='brackets'><code class='function'><code class=brackets><code class='brackets'><code class='function'><code class=brackets>datetime.</code>now</code>()</code>.</code>strftime</code>(<code class='string'>"%d/%m/%Y %H:%M "</code>)</code> + message<br>    <code class='brackets'><code class='function'><code class=brackets>file.</code>writelines</code>(message)</code><br>    <code class='brackets'><code class='function'><code class=brackets>file.</code>close</code>()</code><br>    <code class='statements1'>return</code> message<br><br><br>LENGTH = 16<br><br><code class='statements2'>def</code> <code class='brackets'><code class='function'>startConnection</code>()</code>:<br>    <code class='brackets'><code class='function'><code class=brackets>sock.</code>listen</code>()</code><br>    <code class='statements1'>while</code> True:<br>        <code class='brackets'><code class='function'>print</code>(<code class='string'>'*** Waiting for a connection ***'</code>)</code><br>        connection, client_address = <code class='brackets'><code class='function'><code class=brackets>sock.</code>accept</code>()</code><br>        thread = <code class='brackets'><code class='function'><code class=brackets>threading.</code>Thread</code>(target=aClient, <code class='brackets'><code class='function'>args=</code>(connection, client_address)</code>)</code><br>        <code class='comment'># ^ Thread handles users input while startConnection loop listens for incoming clients. </code><br>        <code class='brackets'><code class='function'><code class=brackets>thread.</code>start</code>()</code><br>        <code class='brackets'><code class='function'>print</code>(f<code class='string'>"connection from client port {PORT} and host name {hostname}"</code>)</code><br><br><code class='statements2'>def</code> <code class='brackets'><code class='function'>handle_ValueError</code>(connection)</code>:<br>    error_message = <code class='string'>"User left or message length wasn't received "</code><br>    error_message = f<code class='string'>"{len(error_message):<{LENGTH}}"</code> + error_message<br>    <code class='brackets'><code class='function'><code class=brackets><code class='brackets'><code class='function'><code class=brackets>connection.</code>sendall</code>(error_message.</code>encode</code>()</code>)</code><br><br><code class='statements2'>def</code> <code class='brackets'><code class='function'>aClient</code>(connection, client_address)</code>:<br>    <code class='statements1'>while</code> True:<br>        try:<br>            data_length = <code class='brackets'><code class='function'><code class=brackets><code class='brackets'><code class='function'><code class=brackets><code class='brackets'><code class='function'>int</code>(connection.</code>recv</code>(LENGTH)</code>.</code>decode</code>()</code>)</code><br>            <code class='comment'># ^ first stream of bytes holds</code><br>            <code class='comment'># the length of the message.</code><br>        <code class='statements1'>except</code> ValueError:<br>            <code class='brackets'><code class='function'>print</code>(<code class='string'>"Couldn't convert first message to int"</code>)</code><br>            <code class='brackets'><code class='function'>handle_ValueError</code>(connection)</code><br>            <code class='statements1'>break</code><br>        message = <code class='string'>""</code><br>        data_received = 0<br>        <code class='statements1'>while</code> True:<br>            <code class='statements1'>if</code> data_received < data_length:<br>                data = <code class='brackets'><code class='function'><code class=brackets><code class='brackets'><code class='function'><code class=brackets>connection.</code>recv</code>(LENGTH)</code>.</code>decode</code>()</code><br>                <code class='brackets'><code class='function'>print</code>(<code class='string'>'received "%s"'</code> % data)</code><br>                message += data<br>                data_received += <code class='brackets'><code class='function'>len</code>(data)</code><br>            else:<br>                message = <code class='brackets'><code class='function'>logMessage</code>(message+<code class='string'>"\n"</code>)</code><br>                message = f<code class='string'>"{len(message):<{LENGTH}}"</code> + message  <code class='comment'># adds length fragment to let client know of length.</code><br>                <code class='brackets'><code class='function'><code class=brackets><code class='brackets'><code class='function'><code class=brackets>connection.</code>sendall</code>(message.</code>encode</code>()</code>)</code><br>                <code class='brackets'><code class='function'>print</code>(<code class='string'>'no more data from'</code>, client_address)</code><br>                <code class='statements1'>break</code><br>        <code class='statements1'>break</code><br>    <code class='brackets'><code class='function'><code class=brackets>connection.</code>close</code>()</code><br>    <code class='brackets'><code class='function'>print</code>(<code class='string'>"Connection closed"</code>)</code><br><br><code class='brackets'><code class='function'>startConnection</code>()</code><br><code class='brackets'><code class='function'><code class=brackets>sock.</code>close</code>()</code><br><br><br> </pre></code>